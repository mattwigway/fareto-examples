{"version":3,"sources":["icons.js","ODMap.js","timeutil.js","ProfileRequestUI.js","ParetoSurface.js","Leg.js","Itinerary.js","ParetoResult.js","App.js","serviceWorker.js","index.js"],"names":["startIcon","icon","iconUrl","iconAnchor","iconSize","popupAnchor","endIcon","ODMap","props","setFromCoords","fromMarker","current","leafletElement","getLatLng","lat","lng","setCoords","fromLat","fromLon","setToCoords","toMarker","toLat","toLon","renderTrip","trip","stops","coords","legs","forEach","l","push","originLon","originLat","destLon","destLat","geom","coordinates","c","line","type","geometry","GeoJSON","key","Math","random","data","map","lon","CircleMarker","center","radius","React","createRef","tileLayer","process","REACT_APP_MAPBOX_TOKEN","TileLayer","url","tileSize","zoomOffset","attribution","Map","this","zoom","Marker","draggable","onDragend","position","ref","Popup","result","trips","tripIndex","Component","secondsToTime","seconds","hours","floor","minutes","secs","String","padStart","timeToSeconds","time","spl","split","parseInt","ProfileRequestUI","setRequestFields","fields","setState","profileRequest","Object","assign","state","setFromTime","e","fromTime","target","value","toTime","setDate","date","setFareCalculatorType","inRoutingFareCalculator","setCustomProfileRequestJson","customProfileRequestJson","handleSubmit","preventDefault","custom","hashState","fareCalculatorType","window","location","hash","encodeURIComponent","JSON","stringify","parse","err","alert","fetch","method","headers","body","then","res","a","ok","json","setError","setResults","text","shouldSetExtentFromMetadata","search","load","URLSearchParams","get","undefined","test","request","decodeURIComponent","slice","Number","meta","envelope","maxY","minY","maxX","minX","class","mapCenter","mapZoom","onSubmit","for","name","id","onChange","colspan","ParetoSurface","maxCost","maxTime","sortedTrips","t","i","sort","b","durationSeconds","minCostSoFar","Infinity","optimal","fare","min","filterNonOptimal","filter","max","costScale","cost","timeScale","points","length","lastx","lasty","join","x","y","timeLabels","costLabels","timeStep","nTimeLabels","costStep","nCostLabels","width","height","style","textAnchor","alignmentBaseline","toFixed","transform","x1","x2","y1","y2","stroke","fontSize","route","route_short_name","route_long_name","fill","cx","cy","r","onClick","setTripIndex","Leg","toggleTransferAllowance","transferAllowanceExpanded","leg","renderTransitLeg","renderTransferLeg","transferAllowance","originStopName","originStopId","originTime","destStopName","destStopId","destTime","cumulativeFare","Itinerary","finalLegCoords","features","properties","renderLegGeoJson","btoa","idx","index","route_type","href","renderGeoJson","download","ParetoResult","setFilter","checked","computeTimeMillis","App","errorText","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.09e9e79f.chunk.js","sourcesContent":["/*\n * Leaflet icons for start and end. Copied from github.com/conveyal/otp.js.\n */\n\nimport {icon} from 'leaflet'\n\nexport const startIcon = icon({\n    iconUrl: 'data:image/png;base64,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',\n    iconAnchor: [44, 41],\n    iconSize: [48, 49],\n    popupAnchor: [24, 0]\n})\n\nexport const endIcon = icon({\n    iconUrl: 'data:image/png;base64,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',\n    iconAnchor: [44, 41],\n    iconSize: [48, 49],\n    popupAnchor: [24, 0]\n})","import React from 'react'\nimport {Map, TileLayer, Marker, Popup, GeoJSON, CircleMarker} from 'react-leaflet'\n\nimport {startIcon, endIcon} from './icons'\n\nexport default class ODMap extends React.Component {\n    constructor(props) {\n        super(props)\n        this.fromMarker = React.createRef()\n        this.toMarker = React.createRef()\n    }\n\n    setFromCoords = () => {\n        if (this.fromMarker.current != null) {\n            const {lat, lng} = this.fromMarker.current.leafletElement.getLatLng()\n            this.props.setCoords({\n                fromLat: lat,\n                fromLon: lng\n            })\n        }\n    }\n\n    setToCoords = () => {\n        if (this.toMarker.current != null) {\n            const {lat, lng} = this.toMarker.current.leafletElement.getLatLng()\n            this.props.setCoords({\n                toLat: lat,\n                toLon: lng\n            })\n        }\n    }\n\n    render () {\n        let tileLayer\n        if (process.env.REACT_APP_MAPBOX_TOKEN) {\n            // Mapbox Streets\n            tileLayer = <TileLayer\n                url={\"https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=\" + process.env.REACT_APP_MAPBOX_TOKEN}\n                tileSize={512}\n                zoomOffset={-1}\n                attribution='© <a href=\"https://apps.mapbox.com/feedback/\">Mapbox</a> © <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n                />\n        } else {\n            // Stock OSM\n            tileLayer = <TileLayer\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                />\n        }\n\n        return <Map center={this.props.center} zoom={this.props.zoom}>\n            {tileLayer}\n            <Marker\n                draggable={true}\n                onDragend={this.setFromCoords}\n                position={[this.props.coords.fromLat, this.props.coords.fromLon]}\n                icon={startIcon}\n                ref={this.fromMarker} >\n                <Popup>Origin</Popup>\n            </Marker>\n\n            <Marker\n                draggable={true}\n                onDragend={this.setToCoords}\n                position={[this.props.coords.toLat, this.props.coords.toLon]}\n                icon={endIcon}\n                ref={this.toMarker} >\n                <Popup>Destination</Popup>\n            </Marker>\n\n            {this.props.result && this.props.result.trips && this.props.tripIndex != null && this.renderTrip(this.props.result.trips[this.props.tripIndex])}\n        </Map>\n    }\n\n    renderTrip = (trip) => {\n        // create geojson for leaflet\n        const stops = []\n        const coords = [[this.props.coords.fromLon, this.props.coords.fromLat]]\n        // TODO eventually make them different colors for walk, ride\n        trip.legs.forEach(l => {\n            stops.push([l.originLon, l.originLat])\n            stops.push([l.destLon, l.destLat])\n            l.geom.coordinates.forEach(c => coords.push(c))\n        })\n\n        coords.push([this.props.coords.toLon, this.props.coords.toLat])\n        \n        const line = {\n            type: 'Feature',\n            geometry: {\n                type: \"LineString\",\n                coordinates: coords\n            }\n        }\n\n        // force replace on re-render, GeoJSON does not update\n        return <>\n            <GeoJSON key={Math.random()} data={line} />\n            {stops.map(([lon, lat]) => <CircleMarker center={[lat, lon]} radius={4} />)}\n        </>\n    }\n}","/** seconds since midnight to HH:MM */\nexport function secondsToTime (seconds) {\n    const hours = Math.floor(seconds / 3600)\n    const minutes = Math.floor((seconds % 3600) / 60)\n    const secs = seconds % 60\n    return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`\n}\n\n/** HH:MM to seconds since midnight */\nexport function timeToSeconds (time) {\n    const spl = time.split(':')\n    const hours = parseInt(spl[0])\n    const minutes = parseInt(spl[1])\n    return hours * 3600 + minutes * 60\n}","import React from 'react'\nimport ODMap from './ODMap'\nimport {timeToSeconds, secondsToTime} from './timeutil'\n\nexport default class ProfileRequestUI extends React.Component {\n    constructor (props) {\n        super(props)\n\n        // not the best place to store all the defaults\n        this.state = {\n            profileRequest : {\n                \"fromLat\": 40.768540,\n                \"fromLon\": -73.527855,\n                \"toLat\": 40.712302,\n                \"toLon\": -73.623859,\n                \"fromTime\": 25200,\n                \"toTime\": 25260,\n                \"walkSpeed\": 1.3888888,\n                \"bikeSpeed\": 4.1666665,\n                \"bikeTrafficStress\": 4,\n                \"carSpeed\": 20,\n                \"streetTime\": 90,\n                \"maxWalkTime\": 20,\n                \"maxBikeTime\": 20,\n                \"maxCarTime\": 45,\n                \"minBikeTime\": 10,\n                \"minCarTime\": 10,\n                \"date\": \"2019-12-16\",\n                \"limit\": 0,\n                \"accessModes\": \"WALK\",\n                \"egressModes\": \"WALK\",\n                \"directModes\": \"WALK\",\n                \"transitModes\": \"TRAM,SUBWAY,RAIL,BUS,FERRY,CABLE_CAR,GONDOLA,FUNICULAR\",\n                \"suboptimalMinutes\": 5,\n                \"maxTripDurationMinutes\": 120,\n                \"maxRides\": 4,\n                \"inRoutingFareCalculator\": {\"type\": \"nyc\"},\n                \"monteCarloDraws\": 1,\n                \"maxFare\": 200000\n            },\n            customProfileRequestJson: '{\\n\\n}',\n            // defaults will be overwritten by ?load= JSON or router metadata, just put something here so map can load\n            \"mapCenter\": [33.41945, -111.93721],\n            \"mapZoom\": 12\n        }\n    }\n\n    // hacky way to handle history/deep linking but it works\n    componentDidMount () {\n        // when serving static sites, don't try to fetch metadata\n        let shouldSetExtentFromMetadata = true\n        if (window.location.search) {\n            const params = new URLSearchParams(window.location.search)\n            const load = params.get('load')\n            if (load !== undefined) {\n                // Load a pre-rendered route, saved as JSON on the server\n                // for safety, make sure there are no slashes, etc. in the url\n                // in case this is ever deployed on an authenticated site, someone might be able to do something\n                // nasty by forcing requests to their domain with a malicious URL (I don't think they could, but maybe)\n                if (/^[a-zA-Z0-9\\-_]+$/.test(load)) {\n                    shouldSetExtentFromMetadata = false\n                    fetch(`results/${load}.json`)\n                    .then(async (res) => {\n                        if (res.ok) {\n                            const json = await res.json()\n                            this.props.setError(null)\n                            this.props.setResults(json)\n\n                            // need also to update parameters\n                            this.setRequestFields({\n                                fromLat: json.request.fromLat,\n                                fromLon: json.request.fromLon,\n                                toLat: json.request.toLat,\n                                toLon: json.request.toLon,\n                                inRoutingFareCalculator: { type: json.request.fareCalculatorType },\n                                fromTime: json.request.fromTime,\n                                toTime: json.request.toTime + 60,\n                                date: json.request.date\n                            })\n\n                            this.setState({\n                                'mapCenter': [\n                                    (json.request.fromLat + json.request.toLat) / 2,\n                                    (json.request.fromLon + json.request.toLon) / 2\n                                ],\n                                'mapZoom': 12 // TODO set zoom based on extents\n                            })\n                        } else {\n                            this.props.setError(await res.text())\n                            this.props.setResults(null)\n                        }\n                    })\n                } else {\n                    this.props.setError('Invalid character in result name!')\n                }\n            }\n        } else if (window.location.hash) {\n            const hashState = JSON.parse(decodeURIComponent(window.location.hash.slice(1)))\n\n            // enforce formatting of strings\n            if (!/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(hashState.date)) {\n                this.props.setError('invalid date format, should be YYYY-MM-DD')\n            } else if (!/^[a-zA-Z-]+$/.test(hashState.fareCalculatorType)) {\n                this.props.setError('invalid fare calculator type') \n            } else {\n                // Make a new request\n                this.setRequestFields({\n                    fromLat: Number(hashState.fromLat),\n                    fromLon: Number(hashState.fromLon),\n                    toLat: Number(hashState.toLat),\n                    toLon: Number(hashState.toLon),\n                    inRoutingFareCalculator: { type: hashState.fareCalculatorType },\n                    fromTime: Number(hashState.time),\n                    toTime: Number(hashState.time + 60),\n                    date: hashState.date\n                })\n            }\n        }\n\n        if (shouldSetExtentFromMetadata) {\n            fetch('/metadata')\n            .then(async (res) => {\n                if (res.ok) {\n                    const meta = await res.json()\n                    this.setState({\n                        \"mapCenter\": [\n                            (meta.envelope.maxY + meta.envelope.minY) / 2,\n                            (meta.envelope.maxX + meta.envelope.minX) / 2\n                        ],\n                        \"zoom\": 12\n                    })\n                } else {\n                    this.props.setError(await res.text())\n                }\n            })\n        }\n    }\n\n    setRequestFields = (fields) => {\n        this.setState({ profileRequest: Object.assign({}, this.state.profileRequest, fields)})\n    }\n\n    // setToTime = (e) => {\n    //     this.setRequestFields({toTime: timeToSeconds(e.target.value)})\n    // }\n\n    setFromTime = (e) => {\n        this.setRequestFields({\n            fromTime: timeToSeconds(e.target.value),\n            toTime: timeToSeconds(e.target.value) + 60\n        })\n    }\n\n    setDate = (e) => {\n        this.setRequestFields({date: e.target.value})\n    }\n\n    setFareCalculatorType = (e) => {\n        this.setRequestFields({\n            inRoutingFareCalculator: Object.assign({}, this.state.inRoutingFareCalculator, {type: e.target.value})\n        })\n    }\n\n    setCustomProfileRequestJson = (e) => {\n        this.setState({\n            customProfileRequestJson: e.target.value\n        })\n    }\n\n    handleSubmit = (e) => {\n        e.preventDefault() // prevent reload\n\n        // update hash only on submit\n        // hacky way to handle hash\n        // TODO persist map state\n        const hashState = {\n            fromLat: this.state.profileRequest.fromLat,\n            fromLon: this.state.profileRequest.fromLon,\n            toLat: this.state.profileRequest.toLat,\n            toLon: this.state.profileRequest.toLon,\n            fareCalculatorType: this.state.profileRequest.inRoutingFareCalculator.type,\n            time: this.state.profileRequest.fromTime,\n            date: this.state.profileRequest.date,\n            customProfileRequestJson: this.state.customProfileRequestJson\n        }\n\n        window.location.hash = '#' + encodeURIComponent(JSON.stringify(hashState))\n\n        let custom\n        try {\n            custom = JSON.parse(this.state.customProfileRequestJson)\n        } catch (err) {\n            alert(`Error parsing custom JSON: ${err}`)\n        }\n\n        fetch('/pareto', { // TODO hardcoded URL\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(Object.assign({}, this.state.profileRequest, custom))\n        })\n        .then(async (res) => {\n            if (res.ok) {\n                const json = await res.json()\n                this.props.setError(null)\n                this.props.setResults(json)\n            } else {\n                this.props.setError(await res.text())\n                this.props.setResults(null)\n            }\n        })\n    }\n\n    render () {\n        return <div class=\"paretoControls\">\n            <ODMap setCoords={this.setRequestFields} coords={this.state.profileRequest} result={this.props.result} tripIndex={this.props.tripIndex}\n                center={this.state.mapCenter} zoom={this.state.mapZoom} />\n\n            <form onSubmit={this.handleSubmit}>\n                <table>\n                    <tbody>\n                        <tr>\n                            <td><label for=\"fareCalculatorType\">Fare calculator type</label></td>\n                            <td><input type=\"text\" name=\"fareCalculatorType\" id=\"fareCalculatorType\" value={this.state.profileRequest.inRoutingFareCalculator.type} onChange={this.setFareCalculatorType} /></td>\n                        </tr>\n                        <tr>\n                            <td><label for=\"date\">Date</label></td>\n                            <td><input type=\"date\" name=\"date\" id=\"date\" value={this.state.profileRequest.date} onChange={this.setDate} /></td>\n                        </tr>\n                        <tr>\n                            <td><label for=\"fromTime\">Time</label></td>\n                            <td><input type=\"time\" name=\"fromTime\" id=\"fromTime\" value={secondsToTime(this.state.profileRequest.fromTime)} onChange={this.setFromTime} /></td>\n                        </tr>\n                        <tr>\n                            <td><label for=\"customJson\">Custom profile request JSON</label></td>\n                            <td><textarea id=\"customJson\" name=\"customJson\" onChange={this.setCustomProfileRequestJson} value={this.state.customProfileRequestJson} /></td>\n                        </tr>\n                        <tr>\n                            <td colspan={2}><input type=\"submit\" value=\"Route\" /></td>\n                        </tr>\n                    </tbody>\n                </table>\n            </form>\n        </div>\n    }\n}","import React from 'react'\nimport {secondsToTime} from './timeutil'\n\n// TODO make configurable\nconst FARE_SCALE = 100\nconst FARE_DECIMALS = 2\nconst FARE_SYMBOL = '$'\n\nfunction formatFare (fare) {\n    return `${FARE_SYMBOL}${(fare / FARE_SCALE).toFixed(FARE_DECIMALS)}`\n}\n\n/** The actual Pareto curve itself */\nexport default class ParetoSurface extends React.Component {\n    render () {\n        // SCALING\n        let maxCost = 0\n        let maxTime = 0\n\n        // sort by time\n        let sortedTrips = this.props.result.trips.slice(0) // copy\n        sortedTrips.forEach((t, i) => t.tripIndex = i) // okay since it's a copy\n        sortedTrips.sort((a, b) => a.durationSeconds - b.durationSeconds)\n\n        let minCostSoFar = Infinity\n\n        sortedTrips.forEach(t => {\n            t.optimal = t.fare < minCostSoFar // since it's sorted, prev. trips guaranteed to be faster. Unless this is lower cost, it's not optimal.\n            minCostSoFar = Math.min(minCostSoFar, t.fare)\n        })\n\n        if (this.props.filterNonOptimal) {\n            // The algorithm can return some non-pareto-optimal trips (because of transfer allowances to future services not taken).\n            // Since this is a debug tool, it is sometimes helpful to show these, but usually not. Filter them out unless user unchecks\n            // \"filter trips\" box.\n            sortedTrips = sortedTrips.filter(t => t.optimal)\n        }\n\n        sortedTrips.forEach(trip => {\n            maxCost = Math.max(maxCost, trip.fare)\n            maxTime = Math.max(maxTime, trip.durationSeconds)\n        })\n\n        // TODO this breaks for systems not in decimal values with 100 being a reasonable amount\n        maxCost += (50 - maxCost % 50)\n        maxTime += (15 * 60 - maxTime % (15 * 60))\n\n        const costScale = (cost) => 400 - (40 + cost / maxCost * 340)\n        const timeScale = (time) => 70 + time / maxTime * 870\n\n        // create points for the Pareto frontier itself\n        let points = []\n\n        if (sortedTrips.length > 0) {\n            let lastx = timeScale(sortedTrips[0].durationSeconds)\n            let lasty = costScale(sortedTrips[0].fare)\n            points.push([lastx, lasty].join(','))\n\n            // draw the pareto curve, but since it's not smooth, draw with 90 degree angles\n            // i.e. graph should look like -| not \\\n            if (sortedTrips.length > 1) {\n                sortedTrips.slice(1).forEach((trip) => {\n                    let x = timeScale(trip.durationSeconds)\n                    let y = costScale(trip.fare)\n\n                    points.push([x, lasty].join(','))\n                    points.push([x, y].join(','))\n                    lastx = x\n                    lasty = y\n                })\n            }\n        }\n\n        points = points.join(' ')\n\n        const timeLabels = []\n        const costLabels = []\n\n        let timeStep = 15 * 60\n        let nTimeLabels = maxTime / timeStep\n        while (nTimeLabels > 6) {\n            timeStep *= 2\n            nTimeLabels = maxTime / timeStep\n        }\n\n        let costStep = 25 // again assuming a US-dollar-like currency\n        let nCostLabels = maxCost / costStep\n        while (nCostLabels > 6) {\n            costStep *= 2\n            nCostLabels = maxCost / costStep\n        }\n\n        for (let i = 0; i < nTimeLabels; i++) timeLabels.push(i * timeStep)\n        for (let i = 0; i < nCostLabels; i++) costLabels.push(i * costStep)\n\n        timeLabels.push(maxTime)\n        costLabels.push(maxCost)\n\n        return <svg width={1000} height={400}>\n            <g>\n                <g>\n                    {costLabels.map(c => <text x={timeScale(0) - 5} style={{textAnchor: \"end\", alignmentBaseline: \"middle\"}} key={c} y={costScale(c)}>{formatFare(c)}</text>)}\n                    <text key=\"cost\" x={0} y={200} transform=\"rotate(-90 15 200)\">Cost</text>\n                    {timeLabels.map(t => <text key={t} x={timeScale(t)} y={375} style={{textAnchor: \"middle\"}}>{secondsToTime(t)}</text>)}\n                    <text key=\"time\" x={475} y={392}>Travel time</text>\n                </g>\n                <g>\n                    {costLabels.map((c, i, a) => <line key={`cost-grid-${c}`} x1={timeScale(0)} x2={timeScale(maxTime)}\n                        y1={costScale(c)} y2={costScale(c)}\n                        style={{stroke: i === 0 || i  === a.length - 1 ? 'black' : 'lightgrey'}} />)}\n                    {timeLabels.map((t, i, a) => <line key={`time-grid-${t}`} x1={timeScale(t)} x2={timeScale(t)}\n                        y1={costScale(0)} y2={costScale(maxCost)}\n                        style={{stroke: i === 0 || i  === a.length - 1 ? 'black' : 'lightgrey'}} />)}\n                </g>\n                <g style={{stroke: 'gray', fontSize: '8pt', textAnchor: 'end', alignmentBaseline: 'middle'}}>\n                    {sortedTrips.map(t => <text x={timeScale(t.durationSeconds - 40)} y={costScale(t.fare) + 5}>\n                        {t.legs.filter(l => l.type === \"transit\").map(l => l.route.route_short_name != null ? l.route.route_short_name : l.route.route_long_name).join(', ')}\n                        </text>)}\n                </g>\n                <g>\n                    <polyline points={points} stroke=\"black\" fill=\"none\" />\n                    {/* using unsorted here so tripIndex is correct */}\n                    {sortedTrips.map(t => <circle\n                        cx={timeScale(t.durationSeconds)}\n                        cy={costScale(t.fare)}\n                        r={3}\n                        fill={t.tripIndex === this.props.tripIndex ? \"red\" : \"black\"}\n                        stroke={t.tripIndex === this.props.tripIndex ? \"red\" : \"black\"}\n                        onClick={() => this.props.setTripIndex(t.tripIndex)} />)}\n                </g>\n            </g>\n        </svg>\n    }\n}","/**\n * Represents a leg of a journey\n*/\n\nimport React, {Component} from 'react'\nimport {secondsToTime} from './timeutil'\n\nexport default class Leg extends Component {\n    constructor (props) {\n        super(props)\n        this.state = {\n            'transferAllowanceExpanded': false\n        }\n    }\n\n    toggleTransferAllowance = (e) => {\n        e.preventDefault()\n        this.setState({'transferAllowanceExpanded': !this.state.transferAllowanceExpanded})\n    }\n\n    render () {\n        const {leg} = this.props\n        return <li>\n            {leg.type === 'transit' && this.renderTransitLeg()}\n            {leg.type === 'transfer' && this.renderTransferLeg()}\n            &nbsp;&nbsp;\n            <button onClick={this.toggleTransferAllowance}>\n                {(this.state.transferAllowanceExpanded ? 'Hide' : 'Show')} transfer allowance\n            </button>\n            {(this.state.transferAllowanceExpanded && <pre>\n                {JSON.stringify(leg.transferAllowance, null, 2).slice(2, -2) /* slice removes open/close braces */} \n            </pre>)}\n        </li>\n    }\n\n    renderTransitLeg () {\n        const {leg} = this.props\n        return <>\n            {leg.originStopName} (id: {leg.originStopId}) @ {secondsToTime(leg.originTime)} =>&nbsp;\n            {leg.destStopName} (id: {leg.destStopId}) @ {secondsToTime(leg.destTime)}&nbsp;\n            via route {leg.route.route_short_name && leg.route.route_short_name} {leg.route.route_long_name && leg.route.route_long_name}&nbsp;\n            (cumulative fare: {leg.cumulativeFare})\n        </>\n    }\n\n    renderTransferLeg () {\n        const {leg} = this.props\n        return <>\n            Transfer from&nbsp;\n            {leg.originStopName} (id: {leg.originStopId}) @ {secondsToTime(leg.originTime)} =>&nbsp;\n            {leg.destStopName} (id: {leg.destStopId}) @ {secondsToTime(leg.destTime)}&nbsp;\n            (cumulative fare: {leg.cumulativeFare})\n        </>\n    }\n}","import React from 'react'\nimport {secondsToTime} from './timeutil'\nimport Leg from './Leg'\n\n/** Displays an itinerary */\nexport default class Itinerary extends React.Component {\n    renderGeoJson () {\n        const finalLegCoords = this.props.trip.legs[this.props.trip.legs.length - 1].geom.coordinates\n        const json = {\n            type: 'FeatureCollection',\n            features: [\n                {\n                    type: 'Feature',\n                    properties: {\n                        'type': 'access'\n                    },\n                    geometry: {\n                        type: 'LineString',\n                        coordinates: [\n                            [this.props.request.fromLon, this.props.request.fromLat],\n                            this.props.trip.legs[0].geom.coordinates[0]\n                        ]\n                    }\n                },\n                ...this.props.trip.legs.map(this.renderLegGeoJson),\n                {\n                    type: 'Feature',\n                    properties: {\n                        'type': 'egress'\n                    },\n                    geometry: {\n                        type: 'LineString',\n                        coordinates: [\n                            finalLegCoords[finalLegCoords.length - 1],\n                            [this.props.request.toLon, this.props.request.toLat]\n                        ]\n                    }\n                },\n            ]\n        }\n\n        return `data:application/json;base64,${btoa(JSON.stringify(json))}`\n    }\n\n    renderLegGeoJson (leg, idx) {\n        return {\n            type: 'Feature',\n            properties: {\n                index: idx,\n                type: leg.type,\n                originStopName: leg.originStopName,\n                originStopId: leg.originStopId,\n                destStopId: leg.destStopId,\n                destStopName: leg.destStopName,\n                route_short_name: leg.type === 'transit' ? leg.route.route_short_name : undefined,\n                route_long_name: leg.type === 'transit' ? leg.route.route_long_name : undefined,\n                route_type: leg.type === 'transit' ? leg.route.route_type : undefined,\n                cumulativeFare: leg.cumulativeFare\n            },\n            geometry: leg.geom\n        }\n    }\n\n    render () {\n        return <div>\n            Duration: {secondsToTime(this.props.trip.durationSeconds)}<br/>\n            Fare: {this.props.trip.fare}<br/>\n            Segments:<br/>\n            <ul>\n                {this.props.trip.legs.map((leg, idx) => <Leg key={idx} leg={leg} />)}\n            </ul>\n\n            <a href={this.renderGeoJson()} download=\"fareto-trip.geojson\">Download itinerary GeoJSON</a>\n        </div>\n    }\n}","import React from 'react'\nimport ParetoSurface from './ParetoSurface'\nimport Itinerary from './Itinerary'\n\n/** encapsulates all the result display */\nexport default class ParetoResult extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {tripIndex: null, filterNonOptimal: true}\n    }\n\n    setFilter = (e) => {\n        this.setState({filterNonOptimal: e.target.checked})\n    }\n\n    render () {\n        return <div class=\"paretoResult\">\n            <ParetoSurface result={this.props.result} setTripIndex={this.props.setTripIndex} tripIndex={this.props.tripIndex} filterNonOptimal={this.state.filterNonOptimal} />\n            <br/>\n            <input type=\"checkbox\" checked={this.state.filterNonOptimal} onChange={this.setFilter} id=\"filter\" />\n            <label for=\"filter\">Remove non-Pareto-optimal trips (retained due to transfer allowance)</label>\n            {this.props.tripIndex !== null && <Itinerary trip={this.props.result.trips[this.props.tripIndex]} request={this.props.result.request} />}\n            <br/>\n            Computed in {this.props.result.computeTimeMillis}ms\n            <br/>\n            <a href={`data:application/json;base64,${btoa(JSON.stringify(this.props.result))}`} download=\"fareto.json\">Download result JSON</a>\n        </div>\n    }\n}","import React from 'react';\nimport ProfileRequestUI from './ProfileRequestUI'\nimport ParetoResult from './ParetoResult'\nimport './App.css';\n\nclass App extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      errorText: null,\n      result: null,\n      tripIndex: null\n    }\n  }\n\n  setError = (err) => {\n    this.setState({errorText: err, tripIndex: null})\n  }\n\n  setResults = (res) => {\n    this.setState({result: res, tripIndex: null})\n  }\n\n  setTripIndex = (i) => this.setState({tripIndex: i})\n\n  render () {\n    return <>\n      <ProfileRequestUI setError={this.setError} setResults={this.setResults} tripIndex={this.state.tripIndex} result={this.state.result} />\n      {this.state.errorText && <div><span class=\"error-text\">{this.state.errorText}</span></div>}\n      {this.state.result && <ParetoResult result={this.state.result} tripIndex={this.state.tripIndex} setTripIndex={this.setTripIndex} key={Math.random()} />}\n    </>\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}