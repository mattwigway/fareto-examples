(this.webpackJsonpfareto=this.webpackJsonpfareto||[]).push([[0],{26:function(e,t,r){e.exports=r(36)},31:function(e,t,r){},35:function(e,t,r){},36:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(14),s=r.n(o),i=(r(31),r(8)),l=r(6),u=r(9),c=r(10),p=r(11),m=r.n(p),d=r(20),f=r(24),h=r(38),g=r(39),E=r(42),A=r(41),x=r(40),y=r(43),b=r(4),v=Object(b.icon)({iconUrl:"data:image/png;base64,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",iconAnchor:[44,41],iconSize:[48,49],popupAnchor:[24,0]}),C=Object(b.icon)({iconUrl:"data:image/png;base64,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",iconAnchor:[44,41],iconSize:[48,49],popupAnchor:[24,0]}),L=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).setFromCoords=function(){if(null!=a.fromMarker.current){var e=a.fromMarker.current.leafletElement.getLatLng(),t=e.lat,r=e.lng;a.props.setCoords({fromLat:t,fromLon:r})}},a.setToCoords=function(){if(null!=a.toMarker.current){var e=a.toMarker.current.leafletElement.getLatLng(),t=e.lat,r=e.lng;a.props.setCoords({toLat:t,toLon:r})}},a.renderTrip=function(e){var t=[],r=[[a.props.coords.fromLon,a.props.coords.fromLat]];e.legs.forEach((function(e){t.push([e.originLon,e.originLat]),t.push([e.destLon,e.destLat]),e.geom.coordinates.forEach((function(e){return r.push(e)}))})),r.push([a.props.coords.toLon,a.props.coords.toLat]);var o={type:"Feature",geometry:{type:"LineString",coordinates:r}};return n.a.createElement(n.a.Fragment,null,n.a.createElement(h.a,{key:Math.random(),data:o}),t.map((function(e){var t=Object(f.a)(e,2),r=t[0],a=t[1];return n.a.createElement(g.a,{center:[a,r],radius:4})})))},a.fromMarker=n.a.createRef(),a.toMarker=n.a.createRef(),a}return Object(l.a)(r,[{key:"render",value:function(){var e;return e=n.a.createElement(E.a,{url:"https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWF0dHdpZ3dheSIsImEiOiJja2RleWp5djYxbWhnMndqcXBzd3hkNGpyIn0.pNQ2GJIN8ppNTc1z9MYx8A",tileSize:512,zoomOffset:-1,attribution:'\xa9 <a href="https://apps.mapbox.com/feedback/">Mapbox</a> \xa9 <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),n.a.createElement(A.a,{center:this.props.center,zoom:this.props.zoom},e,n.a.createElement(x.a,{draggable:!0,onDragend:this.setFromCoords,position:[this.props.coords.fromLat,this.props.coords.fromLon],icon:v,ref:this.fromMarker},n.a.createElement(y.a,null,"Origin")),n.a.createElement(x.a,{draggable:!0,onDragend:this.setToCoords,position:[this.props.coords.toLat,this.props.coords.toLon],icon:C,ref:this.toMarker},n.a.createElement(y.a,null,"Destination")),this.props.result&&this.props.result.trips&&null!=this.props.tripIndex&&this.renderTrip(this.props.result.trips[this.props.tripIndex]))}}]),r}(n.a.Component);function w(e){var t=Math.floor(e/3600),r=Math.floor(e%3600/60),a=e%60;return"".concat(String(t).padStart(2,"0"),":").concat(String(r).padStart(2,"0"),":").concat(String(a).padStart(2,"0"))}function S(e){var t=e.split(":");return 3600*parseInt(t[0])+60*parseInt(t[1])}var I=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).setRequestFields=function(e){a.setState({profileRequest:Object.assign({},a.state.profileRequest,e)})},a.setFromTime=function(e){a.setRequestFields({fromTime:S(e.target.value),toTime:S(e.target.value)+60})},a.setDate=function(e){a.setRequestFields({date:e.target.value})},a.setFareCalculatorType=function(e){a.setRequestFields({inRoutingFareCalculator:Object.assign({},a.state.inRoutingFareCalculator,{type:e.target.value})})},a.setCustomProfileRequestJson=function(e){a.setState({customProfileRequestJson:e.target.value})},a.handleSubmit=function(e){e.preventDefault();var t,r={fromLat:a.state.profileRequest.fromLat,fromLon:a.state.profileRequest.fromLon,toLat:a.state.profileRequest.toLat,toLon:a.state.profileRequest.toLon,fareCalculatorType:a.state.profileRequest.inRoutingFareCalculator.type,time:a.state.profileRequest.fromTime,date:a.state.profileRequest.date,customProfileRequestJson:a.state.customProfileRequestJson};window.location.hash="#"+encodeURIComponent(JSON.stringify(r));try{t=JSON.parse(a.state.customProfileRequestJson)}catch(n){alert("Error parsing custom JSON: ".concat(n))}fetch("/pareto",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({},a.state.profileRequest,t))}).then(function(){var e=Object(d.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=8;break}return e.next=3,t.json();case 3:r=e.sent,a.props.setError(null),a.props.setResults(r),e.next=14;break;case 8:return e.t0=a.props,e.next=11,t.text();case 11:e.t1=e.sent,e.t0.setError.call(e.t0,e.t1),a.props.setResults(null);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a.state={profileRequest:{fromLat:40.76854,fromLon:-73.527855,toLat:40.712302,toLon:-73.623859,fromTime:25200,toTime:25260,walkSpeed:1.3888888,bikeSpeed:4.1666665,bikeTrafficStress:4,carSpeed:20,streetTime:90,maxWalkTime:20,maxBikeTime:20,maxCarTime:45,minBikeTime:10,minCarTime:10,date:"2019-12-16",limit:0,accessModes:"WALK",egressModes:"WALK",directModes:"WALK",transitModes:"TRAM,SUBWAY,RAIL,BUS,FERRY,CABLE_CAR,GONDOLA,FUNICULAR",suboptimalMinutes:5,maxTripDurationMinutes:120,maxRides:4,inRoutingFareCalculator:{type:"nyc"},monteCarloDraws:1,maxFare:2e5},customProfileRequestJson:"{\n\n}",mapCenter:[33.41945,-111.93721],mapZoom:12,loadCount:0},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=!0,r=!0;if(window.location.search){var a=new URLSearchParams(window.location.search),n=a.get("load");void 0!==n&&(/^[a-zA-Z0-9\-_]+$/.test(n)?(t=!1,r=!1,fetch("results/".concat(n,".json")).then(function(){var t=Object(d.a)(m.a.mark((function t(r){var n,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.ok){t.next=12;break}return t.next=3,r.json();case 3:n=t.sent,e.props.setError(null),e.props.setResults(n),e.setRequestFields({fromLat:n.request.fromLat,fromLon:n.request.fromLon,toLat:n.request.toLat,toLon:n.request.toLon,inRoutingFareCalculator:{type:n.request.inRoutingFareCalculator.type},fromTime:n.request.fromTime,toTime:n.request.toTime+60,date:n.request.date}),e.setState({mapCenter:[(n.request.fromLat+n.request.toLat)/2,(n.request.fromLon+n.request.toLon)/2],mapZoom:12,loadCount:e.state.loadCount+1}),void 0!==(o=a.get("index"))&&/^[0-9]+/.test(o)&&e.props.setTripIndex(parseInt(o)),t.next=18;break;case 12:return t.t0=e.props,t.next=15,r.text();case 15:t.t1=t.sent,t.t0.setError.call(t.t0,t.t1),e.props.setResults(null);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())):this.props.setError("Invalid character in result name!"))}else if(window.location.hash){var o=JSON.parse(decodeURIComponent(window.location.hash.slice(1)));/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(o.date)?/^[a-zA-Z0-9\-]+$/.test(o.fareCalculatorType)?(this.setRequestFields({fromLat:Number(o.fromLat),fromLon:Number(o.fromLon),toLat:Number(o.toLat),toLon:Number(o.toLon),inRoutingFareCalculator:{type:o.fareCalculatorType},fromTime:Number(o.time),toTime:Number(o.time+60),date:o.date}),r=!1):this.props.setError("invalid fare calculator type"):this.props.setError("invalid date format, should be YYYY-MM-DD")}(t||r)&&fetch("/metadata").then(function(){var a=Object(d.a)(m.a.mark((function a(n){var o,s,i;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!n.ok){a.next=10;break}return a.next=3,n.json();case 3:o=a.sent,s=(o.envelope.maxY+o.envelope.minY)/2,i=(o.envelope.maxX+o.envelope.minX)/2,t&&e.setState({mapCenter:[s,i],zoom:12}),r&&e.setRequestFields({fromLat:s+.01,toLat:s-.01,fromLon:i+.01,toLon:i-.01}),a.next=15;break;case 10:return a.t0=e.props,a.next=13,n.text();case 13:a.t1=a.sent,a.t0.setError.call(a.t0,a.t1);case 15:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),this.setState({loadCount:this.state.loadCount+1})}},{key:"render",value:function(){return n.a.createElement("div",{class:"paretoControls"},n.a.createElement(L,{setCoords:this.setRequestFields,coords:this.state.profileRequest,result:this.props.result,tripIndex:this.props.tripIndex,center:this.state.mapCenter,zoom:this.state.mapZoom}),n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement("table",null,n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("label",{for:"fareCalculatorType"},"Fare calculator type")),n.a.createElement("td",null,n.a.createElement("input",{type:"text",name:"fareCalculatorType",id:"fareCalculatorType",value:this.state.profileRequest.inRoutingFareCalculator.type,onChange:this.setFareCalculatorType}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("label",{for:"date"},"Date")),n.a.createElement("td",null,n.a.createElement("input",{type:"date",name:"date",id:"date",value:this.state.profileRequest.date,onChange:this.setDate}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("label",{for:"fromTime"},"Time")),n.a.createElement("td",null,n.a.createElement("input",{type:"time",name:"fromTime",id:"fromTime",defaultValue:w(this.state.profileRequest.fromTime),onChange:this.setFromTime,key:this.state.loadCount}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("label",{for:"customJson"},"Custom profile request JSON")),n.a.createElement("td",null,n.a.createElement("textarea",{id:"customJson",name:"customJson",onChange:this.setCustomProfileRequestJson,value:this.state.customProfileRequestJson}))),n.a.createElement("tr",null,n.a.createElement("td",{colspan:2},n.a.createElement("input",{type:"submit",value:"Route"})))))))}}]),r}(n.a.Component);var F=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this,t=0,r=0,a=this.props.result.trips.slice(0);a.forEach((function(e,t){return e.tripIndex=t})),a.sort((function(e,t){return e.durationSeconds-t.durationSeconds}));var o=1/0;a.forEach((function(e){e.optimal=e.fare<o,o=Math.min(o,e.fare)})),this.props.filterNonOptimal&&(a=a.filter((function(e){return e.optimal}))),a.forEach((function(e){t=Math.max(t,e.fare),r=Math.max(r,e.durationSeconds)})),t+=50-t%50,r+=900-r%900;var s=function(e){return 400-(40+e/t*340)},i=function(e){return 70+e/r*870},l=[];if(a.length>0){var u=i(a[0].durationSeconds),c=s(a[0].fare);l.push([u,c].join(",")),a.length>1&&a.slice(1).forEach((function(e){var t=i(e.durationSeconds),r=s(e.fare);l.push([t,c].join(",")),l.push([t,r].join(",")),u=t,c=r}))}l=l.join(" ");for(var p=[],m=[],d=900,f=r/d;f>6;)f=r/(d*=2);for(var h=25,g=t/h;g>6;)g=t/(h*=2);for(var E=0;E<f;E++)p.push(E*d);for(var A=0;A<g;A++)m.push(A*h);return p.push(r),m.push(t),n.a.createElement("svg",{width:1e3,height:400},n.a.createElement("g",null,n.a.createElement("g",null,m.map((function(e){return n.a.createElement("text",{x:i(0)-5,style:{textAnchor:"end",alignmentBaseline:"middle"},key:e,y:s(e)},(t=e,"".concat("$").concat((t/100).toFixed(2))));var t})),n.a.createElement("text",{key:"cost",x:0,y:200,transform:"rotate(-90 15 200)"},"Cost"),p.map((function(e){return n.a.createElement("text",{key:e,x:i(e),y:375,style:{textAnchor:"middle"}},w(e))})),n.a.createElement("text",{key:"time",x:475,y:392},"Travel time")),n.a.createElement("g",null,m.map((function(e,t,a){return n.a.createElement("line",{key:"cost-grid-".concat(e),x1:i(0),x2:i(r),y1:s(e),y2:s(e),style:{stroke:0===t||t===a.length-1?"black":"lightgrey"}})})),p.map((function(e,r,a){return n.a.createElement("line",{key:"time-grid-".concat(e),x1:i(e),x2:i(e),y1:s(0),y2:s(t),style:{stroke:0===r||r===a.length-1?"black":"lightgrey"}})}))),n.a.createElement("g",{style:{stroke:"gray",fontSize:"8pt",textAnchor:"end",alignmentBaseline:"middle"}},a.map((function(t){return n.a.createElement("text",{x:i(t.durationSeconds-40),y:s(t.fare)+5,onClick:function(){return e.props.setTripIndex(t.tripIndex)}},t.legs.filter((function(e){return"transit"===e.type})).map((function(e){return null!=e.route.route_short_name?e.route.route_short_name:e.route.route_long_name})).join(", "))}))),n.a.createElement("g",null,n.a.createElement("polyline",{points:l,stroke:"black",fill:"none"}),a.map((function(t){return n.a.createElement("circle",{cx:i(t.durationSeconds),cy:s(t.fare),r:3,fill:t.tripIndex===e.props.tripIndex?"red":"black",stroke:t.tripIndex===e.props.tripIndex?"red":"black",onClick:function(){return e.props.setTripIndex(t.tripIndex)}})})))))}}]),r}(n.a.Component),R=r(25),T=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).toggleTransferAllowance=function(e){e.preventDefault(),a.setState({transferAllowanceExpanded:!a.state.transferAllowanceExpanded})},a.state={transferAllowanceExpanded:!1},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props.leg;return n.a.createElement("li",null,"transit"===e.type&&this.renderTransitLeg(),"transfer"===e.type&&this.renderTransferLeg(),"\xa0\xa0",n.a.createElement("button",{onClick:this.toggleTransferAllowance},this.state.transferAllowanceExpanded?"Hide":"Show"," transfer allowance"),this.state.transferAllowanceExpanded&&n.a.createElement("pre",null,JSON.stringify(e.transferAllowance,null,2).slice(2,-2)))}},{key:"renderTransitLeg",value:function(){var e=this.props.leg;return n.a.createElement(n.a.Fragment,null,e.originStopName," (id: ",e.originStopId,") @ ",w(e.originTime)," =>\xa0",e.destStopName," (id: ",e.destStopId,") @ ",w(e.destTime),"\xa0 via route ",e.route.route_short_name&&e.route.route_short_name," ",e.route.route_long_name&&e.route.route_long_name,"\xa0 (cumulative fare: ",e.cumulativeFare,")")}},{key:"renderTransferLeg",value:function(){var e=this.props.leg;return n.a.createElement(n.a.Fragment,null,"Transfer from\xa0",e.originStopName," (id: ",e.originStopId,") @ ",w(e.originTime)," =>\xa0",e.destStopName," (id: ",e.destStopId,") @ ",w(e.destTime),"\xa0 (cumulative fare: ",e.cumulativeFare,")")}}]),r}(a.Component),O=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"renderGeoJson",value:function(){var e=this.props.trip.legs[this.props.trip.legs.length-1].geom.coordinates,t={type:"FeatureCollection",features:[{type:"Feature",properties:{type:"access"},geometry:{type:"LineString",coordinates:[[this.props.request.fromLon,this.props.request.fromLat],this.props.trip.legs[0].geom.coordinates[0]]}}].concat(Object(R.a)(this.props.trip.legs.map(this.renderLegGeoJson)),[{type:"Feature",properties:{type:"egress"},geometry:{type:"LineString",coordinates:[e[e.length-1],[this.props.request.toLon,this.props.request.toLat]]}}])};return"data:application/json;base64,".concat(btoa(JSON.stringify(t)))}},{key:"renderLegGeoJson",value:function(e,t){return{type:"Feature",properties:{index:t,type:e.type,originStopName:e.originStopName,originStopId:e.originStopId,destStopId:e.destStopId,destStopName:e.destStopName,route_short_name:"transit"===e.type?e.route.route_short_name:void 0,route_long_name:"transit"===e.type?e.route.route_long_name:void 0,route_type:"transit"===e.type?e.route.route_type:void 0,cumulativeFare:e.cumulativeFare},geometry:e.geom}}},{key:"render",value:function(){return n.a.createElement("div",null,"Duration: ",w(this.props.trip.durationSeconds),n.a.createElement("br",null),"Fare: ",this.props.trip.fare,n.a.createElement("br",null),"Segments:",n.a.createElement("br",null),n.a.createElement("ul",null,this.props.trip.legs.map((function(e,t){return n.a.createElement(T,{key:t,leg:e})}))),n.a.createElement("a",{href:this.renderGeoJson(),download:"fareto-trip.geojson"},"Download itinerary GeoJSON"))}}]),r}(n.a.Component),k=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).setFilter=function(e){a.setState({filterNonOptimal:e.target.checked})},a.state={tripIndex:null,filterNonOptimal:!0},a}return Object(l.a)(r,[{key:"render",value:function(){return n.a.createElement("div",{class:"paretoResult"},n.a.createElement(F,{result:this.props.result,setTripIndex:this.props.setTripIndex,tripIndex:this.props.tripIndex,filterNonOptimal:this.state.filterNonOptimal}),n.a.createElement("br",null),n.a.createElement("input",{type:"checkbox",checked:this.state.filterNonOptimal,onChange:this.setFilter,id:"filter"}),n.a.createElement("label",{for:"filter"},"Remove non-Pareto-optimal trips (retained due to transfer allowance)"),null!==this.props.tripIndex&&n.a.createElement(O,{trip:this.props.result.trips[this.props.tripIndex],request:this.props.result.request}),n.a.createElement("br",null),null!==this.props.tripIndex&&n.a.createElement(n.a.Fragment,null,"Trip index: ",this.props.tripIndex),n.a.createElement("br",null),"Computed in ",this.props.result.computeTimeMillis,"ms",n.a.createElement("br",null),n.a.createElement("a",{href:"data:application/json;base64,".concat(btoa(JSON.stringify(this.props.result))),download:"fareto.json"},"Download result JSON"))}}]),r}(n.a.Component),q=(r(35),function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).setError=function(e){a.setState({errorText:e,tripIndex:null})},a.setResults=function(e){a.setState({result:e,tripIndex:null})},a.setTripIndex=function(e){return a.setState({tripIndex:e})},a.state={errorText:null,result:null,tripIndex:null},a}return Object(l.a)(r,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(I,{setError:this.setError,setResults:this.setResults,tripIndex:this.state.tripIndex,result:this.state.result,setTripIndex:this.setTripIndex}),this.state.errorText&&n.a.createElement("div",null,n.a.createElement("span",{class:"error-text"},this.state.errorText)),this.state.result&&n.a.createElement(k,{result:this.state.result,tripIndex:this.state.tripIndex,setTripIndex:this.setTripIndex,key:Math.random()}))}}]),r}(n.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.913f2928.chunk.js.map